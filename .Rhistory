library(data.table)
fBIRN_Figures(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
fBIRN_Figures(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
getTolerances <- function(report){
if(class(report) == 'character'){
reportdat <- read.csv(report)
}
longreport <- melt(setDT(reportdat),
id.vars = c('folder','scandate','folder_date','folder_epoch',"scandate_epoch",'epoch_delta'),
variable.name = "measure")
longreport <- as.data.frame(longreport)
dayrange <- 30
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'grey', alpha = .4)
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
}
fBIRN_Figures(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
getTolerances <- function(report){
if(class(report) == 'character'){
reportdat <- read.csv(report)
}
longreport <- melt(setDT(reportdat),
id.vars = c('folder','scandate','folder_date','folder_epoch',"scandate_epoch",'epoch_delta'),
variable.name = "measure")
longreport <- as.data.frame(longreport)
dayrange <- 30
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'grey', alpha = .4)
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
return(longreport)
}
aa <- fBIRN_Figures(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
dim(aa)
aa <- getTolerances(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
dim(aa)
head(aa)
longreport <- aa
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'grey', alpha = .4)
facet_wrap(.~measure,scales = 'free')
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'grey', alpha = .4) +
facet_wrap(.~measure,scales = 'free')
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
getTolerances <- function(report){
if(class(report) == 'character'){
reportdat <- read.csv(report)
}
longreport <- melt(setDT(reportdat),
id.vars = c('folder','scandate','folder_date','folder_epoch',"scandate_epoch",'epoch_delta'),
variable.name = "measure")
longreport <- as.data.frame(longreport)
dayrange <- 30
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
dayrange <- 60
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd60, ymax = value_smooth30+value_smooth_sd60), fill = 'blue', alpha = .4) +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_line(aes(y = value_smooth60),color = 'blue') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
return(longreport)
}
getTolerances(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
getTolerances <- function(report){
if(class(report) == 'character'){
reportdat <- read.csv(report)
}
longreport <- melt(setDT(reportdat),
id.vars = c('folder','scandate','folder_date','folder_epoch',"scandate_epoch",'epoch_delta'),
variable.name = "measure")
longreport <- as.data.frame(longreport)
dayrange <- 30
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
dayrange <- 60
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60), fill = 'blue', alpha = .4) +
geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth30),color = 'red') +
geom_line(aes(y = value_smooth60),color = 'blue') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
return(longreport)
}
longreport <- getTolerances(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
getTolerances <- function(report){
if(class(report) == 'character'){
reportdat <- read.csv(report)
}
longreport <- melt(setDT(reportdat),
id.vars = c('folder','scandate','folder_date','folder_epoch',"scandate_epoch",'epoch_delta'),
variable.name = "measure")
longreport <- as.data.frame(longreport)
dayrange <- 30
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
dayrange <- 60
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
dayrange <- 365
mycol <- sprintf('value_smooth%s',dayrange)
mycolsd <- sprintf('value_smooth_sd%s',dayrange)
longreport[,mycol] <- NA
longreport[,mycolsd] <- NA
#colnames(longreport)[colnames(longreport) == 'temp'] = sprintf('value_smooth%s',dayrange)
for(mes in unique(longreport$measure)){
for(i in which(longreport$measure == mes)){
thisepoch <- longreport$scandate_epoch[i]
myrows <- which(longreport$measure == mes &
!is.na(longreport$scandate_epoch) &
longreport$scandate_epoch > thisepoch - dayrange &
longreport$scandate_epoch < thisepoch + dayrange)
longreport[i,mycol] <- mean(longreport$value[myrows],na.rm = TRUE)
longreport[i,mycolsd] <- sd(longreport$value[myrows],na.rm = TRUE)
}
}
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365), fill = 'yellow', alpha = .4) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60), fill = 'blue', alpha = .4) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = 'yellow') +
geom_line(aes(y = value_smooth60),color = 'blue') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
return(longreport)
}
longreport <- getTolerances(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365), fill = 'green', alpha = .3) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60), fill = 'blue', alpha = .4) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = 'green') +
geom_line(aes(y = value_smooth60),color = 'blue') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365), fill = 'green', alpha = .3) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60), fill = 'blue', alpha = .4) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = '#27AE60') +
geom_line(aes(y = value_smooth60),color = 'blue') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365), fill = 'green', alpha = .3) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60), fill = 'blue', alpha = .4) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = '#196F3D') +
geom_line(aes(y = value_smooth60),color = 'blue') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = '#009933', alpha = .3) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = '#0033cc', alpha = .4) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = '#33ff33') +
geom_line(aes(y = value_smooth60),color = '#33ccff') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = '#009933', alpha = .5) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = '#0033cc', alpha = .5) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = '#33ff33') +
geom_line(aes(y = value_smooth60),color = '#33ccff') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-2*value_smooth_sd365, ymax = value_smooth365+2*value_smooth_sd365),
fill = '#009933', alpha = .2) +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = '#009933', alpha = .5) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = '#0033cc', alpha = .5) +
#  geom_ribbon(aes(y = value_smooth30, ymin = value_smooth30-value_smooth_sd30, ymax = value_smooth30+value_smooth_sd30), fill = 'red', alpha = .4) +
geom_line(aes(y = value_smooth365),color = '#33ff33') +
geom_line(aes(y = value_smooth60),color = '#33ccff') +
#  geom_line(aes(y = value_smooth30),color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave('measures.png',width = 30, height = 20)
head(longreport)
unique(longreport$measure)
summary(longreport)
longreport$measure = as.character(longreport$measure)
summary(longreport)
aa <- subset(longreport, measure %in% c('mean'))
dim(aa)
aa$measure
length(unique(longreport$measure))
20/2.2
9
9
9+5/4*9
20/(5/4)
sqrt(16)
makeFigures <- function(longreport){
longreport$measure <- as.character(longreport$measure)
#all measures
makeFigures_selectedMeasures(longreport,'_allmeasures',30)
#core measures
core_measures = c("percentFluc","drift","driftfit","SNR","SFNR","rdc")
makeFigures_selectedMeasures(subset(longreport, measure %in% core_measures),'_coremeasures',9)
}
makeFigures_selectedMeasures(longreport, suffix,figwidth){
shadegreen <- '#009933'
linegreen <- '#33ff33'
shadeblue <- '#0033cc'
lineblue <- '#33ccff'
#3/2 ratio for figure size.
#1SD, 60&365
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = shadegreen, alpha = .5) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = shadeblue, alpha = .5) +
geom_line(aes(y = value_smooth365),color = linegreen) +
geom_line(aes(y = value_smooth60),color = lineblue) +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-365_1-60%s.png',suffix),width = figwidth, height = figwidth*2/3)
#1&2 SD, 60
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-2*value_smooth_sd60, ymax = value_smooth60+2*value_smooth_sd60),
fill = shadeblue, alpha = .25) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = shadeblue, alpha = .5) +
geom_line(aes(y = value_smooth60),color = lineblue) +
geom_point(data = subset(longreport, value < value_smooth60+2*value_smooth_sd60 & value > value_smooth60-2*value_smooth_sd60), color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-60_2-60%s.png',suffix),width = figwidth, height = figwidth*2/3)
#1&2 SD, 365
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-2*value_smooth_sd365, ymax = value_smooth365+2*value_smooth_sd365),
fill = shadegreen, alpha = .25) +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = shadegreen, alpha = .5) +
geom_line(aes(y = value_smooth365),color = linegreen) +
geom_point(data = subset(longreport, value < value_smooth365+2*value_smooth_sd365 & value > value_smooth365-2*value_smooth_sd365), color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-365_2-365%s.png',suffix),width = figwidth, height = figwidth*2/3)
}
makeFigures <- function(longreport){
longreport$measure <- as.character(longreport$measure)
#all measures
makeFigures_selectedMeasures(longreport,'_allmeasures',30)
#core measures
core_measures = c("percentFluc","drift","driftfit","SNR","SFNR","rdc")
makeFigures_selectedMeasures(subset(longreport, measure %in% core_measures),'_coremeasures',9)
}
makeFigures_selectedMeasures <- function(longreport, suffix,figwidth){
shadegreen <- '#009933'
linegreen <- '#33ff33'
shadeblue <- '#0033cc'
lineblue <- '#33ccff'
#3/2 ratio for figure size.
#1SD, 60&365
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = shadegreen, alpha = .5) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = shadeblue, alpha = .5) +
geom_line(aes(y = value_smooth365),color = linegreen) +
geom_line(aes(y = value_smooth60),color = lineblue) +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-365_1-60%s.png',suffix),width = figwidth, height = figwidth*2/3)
#1&2 SD, 60
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-2*value_smooth_sd60, ymax = value_smooth60+2*value_smooth_sd60),
fill = shadeblue, alpha = .25) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = shadeblue, alpha = .5) +
geom_line(aes(y = value_smooth60),color = lineblue) +
geom_point(data = subset(longreport, value < value_smooth60+2*value_smooth_sd60 & value > value_smooth60-2*value_smooth_sd60), color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-60_2-60%s.png',suffix),width = figwidth, height = figwidth*2/3)
#1&2 SD, 365
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-2*value_smooth_sd365, ymax = value_smooth365+2*value_smooth_sd365),
fill = shadegreen, alpha = .25) +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = shadegreen, alpha = .5) +
geom_line(aes(y = value_smooth365),color = linegreen) +
geom_point(data = subset(longreport, value < value_smooth365+2*value_smooth_sd365 & value > value_smooth365-2*value_smooth_sd365), color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-365_2-365%s.png',suffix),width = figwidth, height = figwidth*2/3)
}
makeFigures(longreport)
makeFigures_selectedMeasures <- function(longreport, suffix,figwidth){
shadegreen <- '#009933'
linegreen <- '#33ff33'
shadeblue <- '#0033cc'
lineblue <- '#33ccff'
#3/2 ratio for figure size.
#1SD, 60&365
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = shadegreen, alpha = .5) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = shadeblue, alpha = .5) +
geom_line(aes(y = value_smooth365),color = linegreen) +
geom_line(aes(y = value_smooth60),color = lineblue) +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-365_1-60%s.png',suffix),width = figwidth, height = figwidth*2/3)
#1&2 SD, 60
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-2*value_smooth_sd60, ymax = value_smooth60+2*value_smooth_sd60),
fill = shadeblue, alpha = .25) +
geom_ribbon(aes(y = value_smooth60, ymin = value_smooth60-value_smooth_sd60, ymax = value_smooth60+value_smooth_sd60),
fill = shadeblue, alpha = .5) +
geom_line(aes(y = value_smooth60),color = lineblue) +
geom_point(data = subset(longreport, value < value_smooth60-2*value_smooth_sd60 | value > value_smooth60+2*value_smooth_sd60), color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-60_2-60%s.png',suffix),width = figwidth, height = figwidth*2/3)
#1&2 SD, 365
ggplot(longreport, aes(x = scandate_epoch, y = value)) +
theme_bw() +
geom_point() +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-2*value_smooth_sd365, ymax = value_smooth365+2*value_smooth_sd365),
fill = shadegreen, alpha = .25) +
geom_ribbon(aes(y = value_smooth365, ymin = value_smooth365-value_smooth_sd365, ymax = value_smooth365+value_smooth_sd365),
fill = shadegreen, alpha = .5) +
geom_line(aes(y = value_smooth365),color = linegreen) +
geom_point(data = subset(longreport, value < value_smooth365-2*value_smooth_sd365 | value > value_smooth365+2*value_smooth_sd365), color = 'red') +
facet_wrap(.~measure,scales = 'free')
ggsave(sprintf('measures_1-365_2-365%s.png',suffix),width = figwidth, height = figwidth*2/3)
}
makeFigures(longreport)
longreport <- getTolerances(file.path('//kumc.edu/data/Research/Hoglund/Bartolotti_J/QA','QA_Report.csv'))
makeFigures(longreport)
